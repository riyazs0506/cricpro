{% extends "base.html" %}
{% block content %}

<h3 class="mb-4">Coach Dashboard</h3>

<div class="row">

  <!-- LEFT -->
  <div class="col-md-4 mb-3">

    <div class="card shadow-sm p-3 mb-3">
      <h5>Quick Actions</h5>

      <a href="{{ url_for('attendance') }}" class="btn btn-success w-100 mt-2">Mark Attendance</a>
      <a href="{{ url_for('coach_create_match') }}" class="btn btn-primary w-100 mt-2">Create Live / Manual Match</a>
      <a href="{{ url_for('manual_match_create') }}" class="btn btn-dark w-100 mt-2">Manual Match Only</a>

      <!-- PRE-MATCH AVAILABILITY -->
      <a href="{{ url_for('pre_match_create') }}" class="btn btn-warning w-100 mt-2">
        Create Pre-Match Availability
      </a>

      <a href="{{ url_for('match_list') }}" class="btn btn-secondary w-100 mt-2">All Matches</a>
      <a href="{{ url_for('coach_player_list') }}" class="btn btn-secondary w-100 mt-2">
                View Players
            </a>
      <a href="{{ url_for('chat_list') }}" class="btn btn-outline-primary w-100 mt-2">ðŸ’¬ Messages</a>


      <a href="{{ url_for('nutrition_home') }}" class="btn btn-success w-100 mt-2">
  ðŸ¥— Nutrition Tracker
</a>

    </div>

    <div class="card shadow-sm p-3">
      <h6>Today's Attendance</h6>
      <p class="text-success fw-bold">Present: {{ attendance_present }}</p>
      <p class="text-danger fw-bold">Absent: {{ attendance_absent }}</p>
    </div>

  </div>

  <!-- RIGHT -->
  <div class="col-md-8">

      <!-- PRE-MATCH AVAILABILITY (LATEST ONLY) -->
      <div class="card shadow-sm p-3 mb-3">
        <h5>Latest Pre-Match Availability</h5>

        {% if latest_pre_match_session %}
          <p class="mb-1">
            <strong>{{ latest_pre_match_session.title }}</strong><br>
            <small>
              {{ latest_pre_match_session.match_date }} |
              {{ latest_pre_match_session.venue }}
            </small>
          </p>

          <a href="{{ url_for('availability_summary',availability_id=latest_pre_match_session.id) }}"
            class="btn btn-outline-primary btn-sm mt-2">
            View Summary
          </a>

          <a href="{{ url_for('coach_pre_match_list') }}"
            class="btn btn-link btn-sm mt-2">
            View All Sessions â†’
          </a>
        {% else %}
          <p class="text-muted">No pre-match availability created yet.</p>
        {% endif %}
      </div>

    <!-- LIVE MATCHES -->
    <div class="card shadow-sm p-3 mb-3">
      <h5>Live Matches</h5>
      {% for m in live_matches %}
        <a href="{{ url_for('scoring_panel', match_id=m.id) }}"
           class="btn btn-outline-success btn-sm mb-1">
          {{ m.title }}
        </a>
      {% else %}
        <p class="text-muted">No live matches</p>
      {% endfor %}
    </div>

    <!-- MANUAL MATCHES -->
    <div class="card shadow-sm p-3 mb-3">
      <h5>Manual Matches</h5>
      {% for m in manual_matches %}
        <a href="{{ url_for('manual_scoring', match_id=m.id) }}"
           class="btn btn-outline-dark btn-sm mb-1">
          {{ m.title }}
        </a>
      {% else %}
        <p class="text-muted">No manual matches</p>
      {% endfor %}
    </div>

    <!-- PLAYER APPROVAL (RESTORED) -->
    <div class="card shadow-sm p-3 mb-3">
      <h5>Players Pending Approval</h5>

      {% if pending_players %}
        <ul class="list-group">
          {% for p in pending_players %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
              {{ p.user.username }}
              <a href="{{ url_for('approve_player', id=p.id) }}"
                 class="btn btn-success btn-sm">
                Approve
              </a>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-muted">No pending players</p>
      {% endif %}
    </div>

    <!-- NOTIFICATIONS -->
    <div class="card shadow-sm p-3">
      <h5>Notifications</h5>

      {% if notifications %}
        {% for n in notifications %}
          <a href="{{ url_for('open_notification', notification_id=n.id) }}"
             class="d-block small text-decoration-none mb-1">
            ðŸ”” {{ n.message }}
          </a>
        {% endfor %}
      {% else %}
        <p class="text-muted small">No notifications</p>
      {% endif %}
    </div>

  </div>
</div>

{% endblock %}
